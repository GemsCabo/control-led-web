<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control LED</title>
    
    <!-- Firebase SDK (ORDEN CORRECTO) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js"></script>

    <!-- Configuración Firebase -->
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyC7j2Wz-991bNK49skyfFNDjCf0Y3bOeDU",
        authDomain: "control-led-web-5905a.firebaseapp.com",
        databaseURL: "https://control-led-web-5905a-default-rtdb.firebaseio.com",
        projectId: "control-led-web-5905a",
        storageBucket: "control-led-web-5905a.firebasestorage.app",
        messagingSenderId: "1074588154745",
        appId: "1:1074588154745:web:7e1a71cb1583dca030cda8"
      };

      // Inicialización CORRECTA
      const app = firebase.initializeApp(firebaseConfig);
      const database = firebase.database();
    </script>

    <style>
      body { font-family: Arial; text-align: center; padding: 20px; }
      button { padding: 15px 30px; font-size: 18px; cursor: pointer; }
      #encender { background: #4CAF50; color: white; }
      #apagar { background: #f44336; color: white; }
    </style>
  </head>

  <body>
    <h2>Control del LED 2</h2>
    <button id="encender" onclick="cambiarEstado(1)">ENCENDER</button>
    <button id="apagar" onclick="cambiarEstado(0)">APAGAR</button>
    <div id="estado"></div>

    <script>
      // Referencia a la base de datos
      const ledRef = firebase.database().ref('foco/apagador');

      // Función actualizada para Firebase
      function cambiarEstado(nuevoEstado) {
        ledRef.set(nuevoEstado)
          .then(() => {
            document.getElementById("estado").innerText = "Estado actualizado";
          })
          .catch(error => {
            document.getElementById("estado").innerText = "Error: " + error.message;
          });
      }

      // Escuchar cambios en tiempo real
      ledRef.on('value', (snapshot) => {
        const estado = snapshot.val();
        document.getElementById("estado").innerText = 
          `Estado actual: ${estado === 1 ? "ENCENDIDO" : "APAGADO"}`;
      });
    </script>
  </body>
</html>
